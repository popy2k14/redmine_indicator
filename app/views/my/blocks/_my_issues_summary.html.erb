<%=
  current_user_ids = [User.current.id] + User.current.group_ids

  querynext = IssueQuery.new(:name => l("issues_next"), :user => User.current)
  querynext.add_filter "assigned_to_id", "=", current_user_ids
  querynext.add_filter "status_id", "o"
  querynext.column_names = settings[:columns].presence || ["project", "tracker", "status", "subject"]
  querynext.sort_criteria = settings[:sort].presence || [["due_date", "desc"]]
  issuesnext = querynext.issues()

  querydue = IssueQuery.new(:name => l("issues_due"), :user => User.current)
  querydue.add_filter "assigned_to_id", "=", current_user_ids
  querydue.add_filter "status_id", "o"
  querydue.add_filter "due_date", "<=", [(Date.today-1).strftime("%Y-%m-%d")]
  querydue.column_names = settings[:columns].presence || ["project", "tracker", "status", "subject"]
  querydue.sort_criteria = settings[:sort].presence || [["due_date", "desc"]]
  issuesdue = querydue.issues()

  querytoday = IssueQuery.new(:name => l("issues_today"), :user => User.current)
  querytoday.add_filter "assigned_to_id", "=", current_user_ids
  querytoday.add_filter "status_id", "o"
  querytoday.add_filter "due_date", "t"
  querytoday.column_names = settings[:columns].presence || ["project", "tracker", "status", "subject"]
  querytoday.sort_criteria = settings[:sort].presence || [["due_date", "desc"]]
  issuestoday = querytoday.issues()

  render :partial => "my/my_block_issues_summary", :locals => {:title => 'default_issue_status_in_progress', :querydue => querydue, :issuesdue => issuesdue, :querytoday => querytoday, :issuestoday => issuestoday, :querynext => querynext, :issuesnext => issuesnext}
%>
